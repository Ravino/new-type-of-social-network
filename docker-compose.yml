version: '2'
services:

  app:
    depends_on:
      - database
    build:
      context: ./
      dockerfile: Dockerfile
    ports:
      - 9080:80
    environment:
      APP_NAME: 'Laravel'
      APP_ENV: 'local'
      APP_KEY: 'base64:B+SfHGdTdca+dxR4pzJ2SRrqFpF1gFS/pgZTHNxDbhw='
      APP_DEBUG: 'true'
      APP_URL: 'http://localhost'
      LOG_CHANNEL: 'stack'
      DB_CONNECTION: 'mysql'
      DB_HOST: '127.0.0.1'
      DB_PORT: 3306
      DB_DATABASE: 'plizi'
      DB_USERNAME: 'root'
      DB_PASSWORD: 'password'
      BROADCAST_DRIVER: 'log'
      CACHE_DRIVER: 'file'
      QUEUE_CONNECTION: 'sync'
      MAIL_MAILER: 'smtp'
      MAIL_HOST: 'smtp.gmail.com'
      MAIL_PORT: 587
      MAIL_USERNAME:
      MAIL_PASSWORD:
      MAIL_ENCRYPTION: 'TLS'
      MAIL_FROM_ADDRESS:
      MAIL_FROM_NAME: "${APP_NAME}"
      PUSHER_APP_ID:
      PUSHER_APP_KEY:
      PUSHER_APP_SECRET:
      PUSHER_APP_CLUSTER: 'mt1'
      MIX_PUSHER_APP_KEY: "${PUSHER_APP_KEY}"
      MIX_PUSHER_APP_CLUSTER: "${PUSHER_APP_CLUSTER}"
      JWT_SECRET: '8WM7E3BeKd7uMjpt7Wpi7y4BTp0nAFzx14Pob5DPBLSbpyz8Io1dzqsKZqBx1QTr'
      ZMQ_DSN: "tcp://127.0.0.1:5555"
      WEBSOCKET_URI: "ws://127.0.0.1:7070"

  database:
    image: mysql:5.6
    volumes:
      - dbdata:/var/lib/mysql
    environment:
      MYSQL_DATABASE: plizi
      MYSQL_USER: root
      MYSQL_PASSWORD: password
      MYSQL_RANDOM_ROOT_PASSWORD: "yes"
    ports:
      - "33061:3306"

volumes:
  dbdata:
